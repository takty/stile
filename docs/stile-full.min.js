"use strict";

/**
 *
 * Base Functions (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-06
 *
 */
window.ST = window['ST'] || {};

(function (NS) {
  var _this = this;

  var initLevels = [[], [], [], [], [], [], [], []];
  document.addEventListener('DOMContentLoaded', function () {
    for (var _i = 0, _initLevels = initLevels; _i < _initLevels.length; _i++) {
      var inits = _initLevels[_i];

      for (var i = 0; i < inits.length; i += 1) {
        inits[i]();
      } // Do not use 'for-of' here for IE

    }
  });

  NS.addInitializer = function (level, fn) {
    initLevels[level].push(fn);
  }; // -------------------------------------------------------------------------


  NS.addStile = function (elm, style) {
    if (elm.dataset.stile) {
      var ssl = ' ' + elm.dataset.stile + ' ';
      var sbb = ' ' + style + ' ';
      if (ssl.indexOf(sbb) !== -1) return;
      elm.dataset.stile = elm.dataset.stile + ' ' + style;
    } else {
      elm.dataset.stile = style;
    } // eslint-disable-next-line no-self-assign


    elm.className = elm.className; // Hack for IE11

    if (!elm.className) elm.removeAttribute('class');
  };

  NS.containStile = function (elm, style) {
    if (!elm.dataset.stile) return false;
    var ssl = ' ' + elm.dataset.stile + ' ';
    var sbb = ' ' + style + ' ';
    return ssl.indexOf(sbb) !== -1;
  };

  NS.removeStile = function (elm, style) {
    if (!elm.dataset.stile) return;
    var ssl = ' ' + elm.dataset.stile + ' ';
    var sbb = ' ' + style + ' ';
    elm.dataset.stile = ssl.replace(sbb, ' ').trim(); // eslint-disable-next-line no-self-assign

    elm.className = elm.className; // Hack for IE11

    if (!elm.className) elm.removeAttribute('class');
  }; // -------------------------------------------------------------------------


  var resizeListeners = [];
  var scrollListeners = [];
  document.addEventListener('DOMContentLoaded', function () {
    window.addEventListener('resize', function () {
      for (var _i2 = 0, _resizeListeners = resizeListeners; _i2 < _resizeListeners.length; _i2++) {
        var l = _resizeListeners[_i2];
        l();
      }
    });
    window.addEventListener('scroll', function () {
      for (var _i3 = 0, _scrollListeners = scrollListeners; _i3 < _scrollListeners.length; _i3++) {
        var l = _scrollListeners[_i3];
        l();
      }
    });
  });

  NS.onResize = function (fn) {
    resizeListeners.push(NS.throttle(fn));
  };

  NS.onScroll = function (fn) {
    scrollListeners.push(NS.throttle(fn));
  };

  NS.throttle = function (fn) {
    var isRunning, that, args;

    function run() {
      isRunning = false;
      fn.apply(that, args);
    }

    return function () {
      that = _this;

      for (var _len = arguments.length, origArgs = new Array(_len), _key = 0; _key < _len; _key++) {
        origArgs[_key] = arguments[_key];
      }

      args = origArgs;
      if (isRunning) return;
      isRunning = true;
      requestAnimationFrame(run);
    };
  }; // -------------------------------------------------------------------------


  NS.makeOffsetFunction = function (fixedElementClass, fixedTopClass) {
    var elmFixed = document.getElementsByClassName(fixedElementClass);

    if (elmFixed && elmFixed.length > 0) {
      elmFixed = elmFixed[0];
      var elmTops = document.getElementsByClassName(fixedTopClass);

      if (elmTops && elmTops.length > 0) {
        return function () {
          var pos = getComputedStyle(elmFixed).position;

          if (pos === 'fixed') {
            var height = 0;

            for (var i = 0; i < elmTops.length; i += 1) {
              height += elmTops[i].offsetHeight;
            }

            return height;
          }

          return 0;
        };
      }

      return function () {
        var pos = getComputedStyle(elmFixed).position;
        return pos === 'fixed' ? elmFixed.offsetHeight : 0;
      };
    }

    return function () {
      return 0;
    };
  };

  NS.getWpAdminBarHeight = function () {
    var wpab = document.getElementById('wpadminbar');
    return wpab && getComputedStyle(wpab).position === 'fixed' ? wpab.offsetHeight : 0;
  };
})(window.ST);
"use strict";

/**
 *
 * Query Functions for Responsive and Browsers (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-06
 *
 */
window.ST = window['ST'] || {};

(function (NS) {
  // eslint-disable-next-line func-style
  var assignScreenSize = function assignScreenSize() {
    var w = window.innerWidth;

    if (w < 600) {
      NS.SCREEN_WIDTH = 'phone';
    } else if (w < 900) {
      NS.SCREEN_WIDTH = 'tablet-portrait';
    } else if (w < 1200) {
      NS.SCREEN_WIDTH = 'tablet-landscape';
    } else if (w < 1800) {
      NS.SCREEN_WIDTH = 'desktop';
    } else {
      NS.SCREEN_WIDTH = 'big-desktop';
    }

    var h = window.innerHeight;

    if (h < 600) {
      NS.SCREEN_HEIGHT = 'tiny';
    } else if (h < 950) {
      NS.SCREEN_HEIGHT = 'small';
    } else if (h < 1200) {
      NS.SCREEN_HEIGHT = 'medium';
    } else {
      NS.SCREEN_HEIGHT = 'large';
    }
  };

  assignScreenSize();
  NS.onResize(assignScreenSize); // -------------------------------------------------------------------------

  var ua = window.navigator.userAgent.toLowerCase();

  if (ua.indexOf('edge') !== -1) {
    NS.BROWSER = 'edge';
  } else if (ua.indexOf('trident/7') !== -1) {
    NS.BROWSER = 'ie11';
  } else if (ua.indexOf('chrome') !== -1 && ua.indexOf('edge') === -1) {
    NS.BROWSER = 'chrome';
  } else if (ua.indexOf('safari') !== -1 && ua.indexOf('chrome') === -1) {
    NS.BROWSER = 'safari';
  } else if (ua.indexOf('firefox') !== -1) {
    NS.BROWSER = 'firefox';
  }

  NS.addInitializer(0, function () {
    var ua = window.navigator.userAgent.toLowerCase();
    var cl = document.body.classList;
    cl.add(NS.BROWSER);

    if (ua.indexOf('iphone') !== -1) {
      cl.add('iphone');
      cl.add('ios');
    }

    if (ua.indexOf('ipad') !== -1) {
      cl.add('ipad');
      cl.add('ios');
    }

    if (ua.indexOf('android') !== -1) {
      cl.add('android');
    }
  });
})(window.ST);
"use strict";

/**
 *
 * Anchor Scroll (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-07
 *
 */
window.ST = window['ST'] || {};

(function (NS) {
  var OFFSET = NS.ANCHOR_OFFSET_ADDITIONAL !== undefined ? NS.ANCHOR_OFFSET_ADDITIONAL : 16;
  var CLS_STICKY_ELM = 'st-sticky-header';
  var CLS_STICKY_ELM_TOP = 'st-sticky-header-top';
  var CLS_LINK_TARGET = 'stile-link-target';
  var SEL_TARGET = '.stile *[id]:not([class])';
  var ST_ANCHOR_OFFSET = 'anchor-offset';
  NS.assignAnchorOffset = assignAnchorOffset; // Export the function

  NS.addInitializer(2, initializeAnchorOffset);

  function scrollTo(tar) {
    window.scrollTo(0, tar.getBoundingClientRect().top + window.pageYOffset);
  } // -------------------------------------------------------------------------


  var getAnchorOffset = NS.makeOffsetFunction(CLS_STICKY_ELM, CLS_STICKY_ELM_TOP);

  function initializeAnchorOffset() {
    if (OFFSET + getAnchorOffset() !== 0) {
      var as1 = Array.prototype.slice.call(document.getElementsByClassName(CLS_LINK_TARGET));
      var as2 = Array.prototype.slice.call(document.querySelectorAll(SEL_TARGET));
      var anchorTargets = as1.concat(filterTarget(as2));
      assignAnchorOffset(anchorTargets);
      if (window.location.hash) hashChanged();
    }

    window.addEventListener('hashchange', hashChanged);
  }

  function filterTarget(ts) {
    var newTs = [];

    for (var i = 0; i < ts.length; i += 1) {
      var t = ts[i];
      var tn = t.tagName;
      if (tn === 'INPUT' || tn === 'BUTTON' || tn === 'SELECT' || tn === 'TEXTAREA') continue;
      newTs.push(t);
    }

    return newTs;
  }

  function hashChanged() {
    var hash = window.location.hash;
    if (hash[0] === '#') hash = hash.substr(1);
    var tar = document.getElementById(hash);

    if (tar) {
      setTimeout(function () {
        scrollTo(tar);
      }, 200);
      setTimeout(function () {
        scrollTo(tar);
      }, 300);
    }
  } // Exported function


  function assignAnchorOffset(ats) {
    for (var i = 0; i < ats.length; i += 1) {
      var at = ats[i];
      var pat = document.createElement('span');
      pat.id = at.id;
      pat.dataset['stile'] = ST_ANCHOR_OFFSET;
      at.style.position = 'relative';
      at.dataset.id = at.id;
      at.id = '';
      at.appendChild(pat);
    }

    NS.onResize(function () {
      setAnchorOffset(ats);
    });
    setTimeout(function () {
      setAnchorOffset(ats);
    }, 100);
  }

  function setAnchorOffset(ats) {
    var offset = getAnchorOffset();
    var wpabH = NS.getWpAdminBarHeight();
    var off = offset + wpabH + OFFSET;

    for (var i = 0; i < ats.length; i += 1) {
      var at = ats[i];
      var pat = document.getElementById(at.dataset.id);
      var newTop = -off;
      pat.style.top = newTop + 'px';
    }
  }
})(window.ST);
"use strict";

/**
 *
 * Smooth Scroll (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-07
 *
 */
window.ST = window['ST'] || {};

(function (NS) {
  var DURATION = 400;
  var DURATION_FAST = 100;
  var ST_NO_ANCHOR_SCROLL = 'no-anchor-scroll';
  var ST_ANCHOR_SCROLL_FAST = 'anchor-scroll-fast';
  var ST_ANCHOR_OFFSET = 'anchor-offset';
  NS.onClickAnchorLink = onClickAnchorLink; // Export the function

  NS.addInitializer(4, initialize);

  function scrollTo(tar) {
    window.scrollTo(0, tar.getBoundingClientRect().top + window.pageYOffset);
  } // -------------------------------------------------------------------------


  var isJumping = false;

  function initialize() {
    var as = document.getElementsByTagName('a');

    for (var i = 0; i < as.length; i += 1) {
      var a = as[i];
      if (NS.containStile(a, ST_NO_ANCHOR_SCROLL)) continue;
      if ((a.className + '').trim() !== '') continue;
      var href = a.getAttribute('href');
      if (!href) continue;

      if (href[0] !== '#' || href === '#') {
        var pos = href.lastIndexOf('#');
        if (pos === -1) continue;
        var url = href.substr(0, pos);
        var pn = window.location.pathname;
        if (pn.lastIndexOf(url) !== pn.length - url.length) continue;
      }

      a.addEventListener('click', onClickAnchorLink);
    }

    document.addEventListener('wheel', function () {
      isJumping = false;
    });
  } // Exported function


  function onClickAnchorLink(e) {
    var href = e.target.getAttribute('href');

    if (href) {
      var pos = href.lastIndexOf('#');
      if (pos !== -1) href = href.substr(pos);
      jumpToHash(e, href);
    }
  }

  function jumpToHash(e, hash) {
    var tar = false;

    if (hash === '#top' || hash === null || hash === '') {
      tar = document.documentElement;
    } else {
      tar = document.getElementById(hash.substr(1));
    }

    if (!tar) return false;
    e.stopPropagation();
    e.preventDefault();
    var dur = NS.containStile(e.target, ST_ANCHOR_SCROLL_FAST) ? DURATION_FAST : DURATION;
    jump(tar, dur);
    pushHistory(hash);
  }

  function jump(tar, duration) {
    var start = window.pageYOffset;
    var posY = tar.getBoundingClientRect().top + window.pageYOffset;
    var wh = document.documentElement.offsetHeight;
    var timeStart, timeElapsed;
    isJumping = true;
    requestAnimationFrame(function (time) {
      timeStart = time;
      loop(time);
    });

    function loop(time) {
      if (!isJumping) return;

      if (wh !== document.documentElement.offsetHeight) {
        // for lazy image loading
        posY = tar.getBoundingClientRect().top + window.pageYOffset;
        wh = document.documentElement.offsetHeight;
      }

      timeElapsed = time - timeStart;
      window.scrollTo(0, easing(timeElapsed, start, posY, duration));
      if (timeElapsed < duration) requestAnimationFrame(loop);else end();
    }

    function end() {
      scrollTo(tar);
      setTimeout(function () {
        scrollTo(tar);
      }, 50);
      if (tar !== document.documentElement) setFocus(tar);
      isJumping = false;
    }

    function easing(t, b, c, d) {
      t /= d / 2;
      if (t < 1) return (c - b) / 2 * t * t + b;
      t--;
      return -(c - b) / 2 * (t * (t - 2) - 1) + b;
    }
  }

  function setFocus(tar) {
    if (!tar) return;
    if (NS.containStile(tar, ST_ANCHOR_OFFSET)) tar = tar.parentElement;

    if (!/^(?:a|select|input|button|textarea)$/i.test(tar.tagName)) {
      tar.tabIndex = -1;
    }

    tar.focus();
  }

  function pushHistory(hash) {
    if (NS.BROWSER === 'ie11') {
      // eslint-disable-next-line func-style
      var hashChanged = function hashChanged() {
        // eslint-disable-next-line no-self-assign
        window.location = window.location;
        window.removeEventListener('hashchange', hashChanged);
      };

      window.addEventListener('hashchange', hashChanged);
    }

    history.pushState(null, null, hash === '#top' ? '' : hash);
  }
})(window.ST);
"use strict";

/**
 *
 * Content Style (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-07
 *
 */
window.ST = window['ST'] || {};

(function (NS) {
  var SEL_TARGET = '.stile';
  NS.addInitializer(2, function () {
    var spans = document.querySelectorAll(SEL_TARGET + ' span');
    modifySpanStyle(spans);
    var fs = document.querySelectorAll(SEL_TARGET + ' iframe');
    modifyIframeStyle(fs);
    var figs = document.querySelectorAll(SEL_TARGET + ' figure');
    modifyFigureStyle(figs);
  }); // Span Styles -------------------------------------------------------------

  function modifySpanStyle(spans) {
    for (var i = 0; i < spans.length; i += 1) {
      var target = spans[i];
      var type = target.style.textDecorationLine;

      if (type === undefined) {
        // for IE11, Edge
        type = target.style.textDecoration;

        if (type === 'underline') {
          target.style.textDecoration = '';
          NS.addStile(target, 'inline-' + type);
        }
      } else {
        if (type === 'underline') {
          target.style.textDecorationLine = '';
          NS.addStile(target, 'inline-' + type);
        }
      }
    }
  } // Iframe Styles -----------------------------------------------------------


  function modifyIframeStyle(fs) {
    for (var i = 0; i < fs.length; i += 1) {
      var f = fs[i];
      var width = f.width;
      var height = f.height;
      if (!width || !height) continue;
      var wrap = document.createElement('SPAN');
      NS.addStile(wrap, 'iframe-wrapper');
      var spacer = document.createElement('DIV');
      spacer.style.paddingTop = 100 * height / width + '%';
      wrap.appendChild(spacer);
      wrap.style.maxWidth = width + 'px';
      f.parentElement.insertBefore(wrap, f);
      wrap.appendChild(f);
    }
  } // Figure Styles -----------------------------------------------------------


  function modifyFigureStyle(figs) {
    for (var i = 0; i < figs.length; i += 1) {
      figs[i].style.width = ''; // Wrap with span for neat centering

      var fcs = figs[i].getElementsByTagName('figcaption');

      if (0 < fcs.length) {
        fcs[0].innerHTML = '<span>' + fcs[0].innerHTML + '</span>';
      }
    }
  }
})(window.ST);
"use strict";

/**
 *
 * Lazy Image Loading
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-07
 *
 */
window.ST = window['ST'] || {};

(function (NS) {
  var SEL_TARGET = '.stile';
  var OFFSET = 100;
  NS.addInitializer(5, initialize); // -------------------------------------------------------------------------

  function initialize() {
    var imgs = document.querySelectorAll(SEL_TARGET + ' img');
    var imgsInTbl = document.querySelectorAll(SEL_TARGET + ' table img');

    for (var i = 0; i < imgs.length; i += 1) {
      var img = imgs[i];
      if ([].indexOf.call(imgsInTbl, img) !== -1) continue;
      if (img.getBoundingClientRect().top >= window.innerHeight + OFFSET) hide(img);
    }

    NS.onScroll(onScroll);
    onScroll();

    function onScroll() {
      for (var _i = 0; _i < imgs.length; _i += 1) {
        var _img = imgs[_i];
        if (!_img.dataset.src) continue;
        if (_img.getBoundingClientRect().top < window.innerHeight + OFFSET) show(_img);
      }
    }

    doBeforePrint(onPrint);

    function onPrint() {
      for (var _i2 = 0; _i2 < imgs.length; _i2 += 1) {
        var _img2 = imgs[_i2];
        if (!_img2.dataset.src) continue;
        show(_img2, true);
      }
    }
  }

  function hide(img) {
    img.dataset['src'] = img.src;
    img.src = 'data:image/gif;base64,R0lGODdhAQABAPAAAP///wAAACwAAAAAAQABAEACAkQBADs=';

    if (img.srcset) {
      img.dataset['srcset'] = img.srcset;
      img.srcset = '';
    }

    img.style.opacity = 0;
    var h = img.getAttribute('height');
    if (h) img.style.minHeight = h + 'px';
  }

  function show(img) {
    var immediately = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

    if (img.dataset.srcset) {
      img.srcset = img.dataset.srcset;
      img.dataset.srcset = '';
    }

    img.src = img.dataset.src;
    img.dataset.src = '';
    img.style.minHeight = '';

    if (immediately) {
      img.style.opacity = '';
    } else {
      setTimeout(function () {
        img.style.opacity = '';
      }, 200);
    }
  }

  function doBeforePrint(func) {
    var forceMediaCheck = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
    window.addEventListener('beforeprint', func, false);

    if (forceMediaCheck || !('onbeforeprint' in window)) {
      if (window.matchMedia) {
        var mediaQueryList = window.matchMedia('print');
        mediaQueryList.addListener(function (mql) {
          if (mql.matches) func();
        });
      }
    }
  }
})(window.ST);
"use strict";

/**
 *
 * Link Style (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-07
 *
 * The function 'isExternalUrl' can be overwritten as follows:
 * <script>ST.isExternalUrl = function (url) { return true; }</script>
 *
 */
window.ST = window['ST'] || {};

(function (NS) {
  var SEL_TARGET = '.stile';
  var SEL_TARGET_ANCHOR = '.stile-anchor';
  var SEL_TARGET_ANCHOR_EXTERNAL = '.stile-anchor-external';
  var PERMITTED_CLASSES = ['alignleft', 'aligncenter', 'alignright', 'size-thumbnail', 'size-small', 'size-medium-small', 'size-medium', 'size-medium-large', 'size-medium_large', 'size-large', 'size-full'];
  var EXT_TABLE = {
    doc: 'word',
    docx: 'word',
    xls: 'excel',
    xlsx: 'excel',
    ppt: 'powerpoint',
    pptx: 'powerpoint',
    pdf: 'pdf'
  };
  NS.addInitializer(2, function () {
    var as = document.querySelectorAll(SEL_TARGET + ' a');
    modifyAnchorStyle(as);
    as = document.querySelectorAll(SEL_TARGET_ANCHOR + ' a');
    modifyAnchorStyle(as);
    as = document.querySelectorAll(SEL_TARGET_ANCHOR_EXTERNAL + ' a');
    modifyAnchorStyleExternal(as);
  }); // -------------------------------------------------------------------------

  function modifyAnchorStyle(as) {
    for (var i = 0; i < as.length; i += 1) {
      var a = as[i];

      if (isImageLink(a)) {
        NS.addStile(a, 'link-image');
        continue;
      }

      if (isEmpty(a)) {
        var url = a.getAttribute('href');
        if (isExternal(url)) NS.addStile(a, 'link-external');
        continue;
      }

      if (isSimple(a)) {
        NS.addStile(a, 'link-simple');

        var _url = a.getAttribute('href');

        if (isAnchor(_url)) {
          NS.addStile(a, 'link-anchor');
        } else {
          if (isUrlLink(a, _url)) NS.addStile(a, 'link-url');
          if (isExternal(_url)) NS.addStile(a, 'link-external');
        }

        addFileType(a, _url);
      }
    }
  }

  function modifyAnchorStyleExternal(as) {
    for (var i = 0; i < as.length; i += 1) {
      var a = as[i];
      var url = a.getAttribute('href');

      if (isExternal(url)) {
        NS.addStile(a, 'link-external');
      }
    }
  } // -------------------------------------------------------------------------


  function isImageLink(a) {
    if (a.className) {
      var _cs = a.className.split(' ');

      for (var i = 0; i < _cs.length; i += 1) {
        if (PERMITTED_CLASSES.indexOf(_cs[i]) === -1) return false;
      }
    }

    var cs = a.childNodes;
    if (cs.length === 0) return false;
    var success = false;

    for (var _i = 0; _i < cs.length; _i += 1) {
      var tn = cs[_i].tagName;

      if (success === false && tn === 'IMG') {
        success = true;
        continue;
      }

      if (tn) return false;
    }

    return success;
  }

  function isEmpty(a) {
    if (a.className) return false;
    var cs = a.childNodes;
    return cs.length === 0;
  }

  function isSimple(a) {
    if (a.className) return false;
    var cs = a.childNodes;
    if (cs.length === 0) return false;

    for (var i = 0; i < cs.length; i += 1) {
      if (cs[i].className) return false;
    }

    for (var _i2 = 0; _i2 < cs.length; _i2 += 1) {
      var tn = cs[_i2].tagName;
      if (tn === 'BR') continue;
      if (tn && isInlineElement(cs[_i2])) continue;
      if (tn) return false;
    }

    return true;
  }

  function isAnchor(url) {
    var pos = url.indexOf('#');
    if (pos === -1) return false;
    var id = url.substr(pos + 1);
    var tar = document.getElementById(id);
    return tar !== null;
  }

  function isUrlLink(a, url) {
    var cs = a.childNodes;
    if (cs.length === 0) return false;
    return a.innerHTML.trim() === url;
  }

  function isInlineElement(elm) {
    var d = getComputedStyle(elm).display;
    return d.indexOf('inline') !== -1;
  } // -------------------------------------------------------------------------
  // Private function


  function isExternal(url) {
    return NS.isExternalUrl(url);
  } // Exported function


  function isExternalUrl(url) {
    if (url === null || url === '') return false;
    if (url.indexOf(location.protocol + '//' + location.host) === 0) return false;
    if (url.match(/^https?:\/\//)) return true;
    if (url.match(/^\/\//)) return true;
    return false;
  } // Export the function


  NS.isExternalUrl = isExternalUrl; // -------------------------------------------------------------------------

  function addFileType(a, url) {
    if (url.length > 0 && url[url.length - 1] === '/') return;
    var dom = url.indexOf('//');

    if (dom !== -1) {
      var fs = url.indexOf('/', dom + 2);
      if (fs === -1) return;
      url = url.substr(fs + 1);
    }

    var idx = url.lastIndexOf('.');
    if (idx === -1) return;
    var ext = url.substr(idx + 1);
    var type = EXT_TABLE[ext];

    if (type) {
      NS.addStile(a, 'link-file');
      NS.addStile(a, 'link-file-' + type);
    }
  }
})(window.ST);
"use strict";

/**
 *
 * List Style (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-07
 *
 */
window.ST = window['ST'] || {};

(function (NS) {
  var CLS_TARGET = 'stile';
  NS.addInitializer(4, function () {
    setStyleForInsideOf(document.getElementsByClassName(CLS_TARGET));
    setStyleDirectlyFor(document.getElementsByTagName('ul'), CLS_TARGET);
    setStyleDirectlyFor(document.getElementsByTagName('ol'), CLS_TARGET);
  }); // -------------------------------------------------------------------------

  function setStyleForInsideOf(ts) {
    for (var j = 0; j < ts.length; j += 1) {
      var t = ts[j];
      var uls = t.getElementsByTagName('ul');

      for (var i = 0; i < uls.length; i += 1) {
        setStyle(uls[i]);
      }

      var ols = t.getElementsByTagName('ol');

      for (var _i = 0; _i < ols.length; _i += 1) {
        setStyle(ols[_i]);
        setCounterReset(ols[_i]);
      }
    }
  }

  function setStyleDirectlyFor(ts, tc) {
    for (var i = 0; i < ts.length; i += 1) {
      var t = ts[i];

      if (!hasListStile(t) && t.classList.contains(tc)) {
        setStyle(t);
        if (t.tagName === 'OL') setCounterReset(t);
      }
    }
  }

  function hasListStile(elm) {
    var stile = elm.dataset['stile'];
    if (!stile) return false;
    var ats = stile.split(' ');

    for (var i = 0; i < ats.length; i += 1) {
      var at = ats[i];
      if (at.indexOf('list-') === 0) return true;
    }

    return false;
  }

  function setStyle(t) {
    var type = t.style.listStyleType;

    if (type !== '' && type !== 'none') {
      t.style.listStyleType = '';
      NS.addStile(t, 'list-' + type);
    }
  }

  function setCounterReset(t) {
    var v = t.getAttribute('start');

    if (v !== null && v !== '') {
      var s = parseInt(v);
      t.style.counterReset = 'li ' + (s + 1);
    }

    var cs = t.children;
    var rev = false;

    if (t.getAttribute('reversed') !== null) {
      var size = 0;

      for (var i = 0; i < cs.length; i += 1) {
        if (cs[i].tagName === 'LI') size += 1;
      }

      t.style.counterReset = 'li ' + (size + 1);
      rev = true;
    }

    for (var _i2 = 0; _i2 < cs.length; _i2 += 1) {
      if (cs[_i2].tagName !== 'LI') continue;

      var _v = cs[_i2].getAttribute('value');

      if (_v !== null && _v !== '') {
        var _s = parseInt(_v);

        cs[_i2].style.counterReset = 'li ' + (_s + (rev ? 1 : -1));
      }
    }
  }
})(window.ST);
"use strict";

/**
 *
 * Table Style - Fixed Header (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-07
 *
 */
window.ST = window['ST'] || {};

(function (NS) {
  var CLS_STICKY_ELM = 'st-sticky-header';
  var CLS_STICKY_ELM_TOP = 'st-sticky-header-top';
  var SEL_TARGET = '.stile';
  var ST_HEADER_CONTAINER = 'fixed-table-header-container';
  var ST_HEADER_TABLE = 'fixed-table-header-table';
  var ST_SCROLL_BAR = 'fixed-table-scroll-bar';
  var ST_ENLARGER_BUTTON = 'enlarger-button';
  var ST_STATE_ENLARGED = 'table-enlarged';
  var ST_OPT_NO_ENLARGER = 'no-enlarger';
  var HEAD_BOTTOM_SHADOW = '0px 0.5rem 0.5rem -0.5rem rgba(0, 0, 0, 0.5)';
  var HEADER_FLOATING_WINDOW_HEIGHT_RATIO = 0.9;
  var ENLARGER_WINDOW_WIDTH_RATIO = 0.9;
  var getTableHeaderOffset = NS.makeOffsetFunction(CLS_STICKY_ELM, CLS_STICKY_ELM_TOP);
  var scrollBarWidth;
  NS.addInitializer(5, function () {
    var tabs = document.querySelectorAll(SEL_TARGET + ' table:not([class])');
    setTimeout(function () {
      initialize(tabs);
    }, 0); // Delay for IE11
  }); // -------------------------------------------------------------------------

  function initialize(tabs) {
    scrollBarWidth = parseInt(getScrollBarWidth());
    var conts = [];

    for (var i = 0; i < tabs.length; i += 1) {
      var tab = tabs[i];
      if (tab.style.height) tab.style.height = '';
      var head = cloneTableHeader(tab);
      var bar = cloneTableScrollBar(tab);
      var etb = NS.containStile(tab, ST_OPT_NO_ENLARGER) ? null : createEnlarger(tab);
      var caps = tab.getElementsByTagName('caption');
      var cap = caps.length ? caps[0] : null;

      if ((NS.BROWSER === 'ie11' || NS.BROWSER === 'edge') && head && cap) {
        tab.insertBefore(cap, tab.firstChild); // Replace the order of caption and header
      }

      var cont = {
        table: tab,
        header: head,
        headerHeight: 0,
        bar: bar,
        etb: etb,
        cap: cap
      };
      initEvents(cont);
      conts.push(cont);
      windowScroll(cont);
      tableScroll(cont);

      if (tab.scrollWidth - tab.offsetWidth <= 1 || tab.offsetWidth >= ENLARGER_WINDOW_WIDTH_RATIO * window.innerWidth) {
        etb.style.display = 'none';
      }

      cont.calcWidth = tab.offsetWidth;
    }

    NS.onScroll(function () {
      for (var _i = 0; _i < tabs.length; _i += 1) {
        windowScroll(conts[_i]);
      }
    });
    NS.onResize(function () {
      for (var _i2 = 0; _i2 < tabs.length; _i2 += 1) {
        windowResize(conts[_i2]);
      }
    });
  }

  function initEvents(cont) {
    var tab = cont.table;
    var tableScrollChanged = false,
        barScrollChanged = false;
    tab.addEventListener('scroll', NS.throttle(function () {
      tableScroll(cont);

      if (tableScrollChanged) {
        tableScrollChanged = false;
      } else {
        cont.bar.scrollLeft = tab.scrollLeft;
        barScrollChanged = true;
      }
    }));
    cont.barScrollListener = NS.throttle(function () {
      if (barScrollChanged) {
        barScrollChanged = false;
      } else {
        tab.scrollLeft = cont.bar.scrollLeft;
        tableScrollChanged = true;
      }
    });
    initBarEvent(cont);
    if (cont.etb) initEnlargerEvent(cont);
  }

  function initBarEvent(cont) {
    cont.bar.addEventListener('scroll', cont.barScrollListener);
  }

  function cloneTableHeader(table) {
    var thead = table.tHead;

    if (!thead) {
      thead = createPseudoTableHeader(table);
      if (!thead) return null;
    }

    var cont = document.createElement('div');
    NS.addStile(cont, ST_HEADER_CONTAINER);
    cont.style.maxWidth = table.getBoundingClientRect().width + 'px';
    cont.style.display = 'none';
    cont.style.top = getTableHeaderOffset() + NS.getWpAdminBarHeight() + 'px';
    cont.style.marginTop = '0'; // for cancel 'stile-margin-basic'

    table.parentNode.appendChild(cont);
    var ptab = document.createElement('div');
    NS.addStile(ptab, ST_HEADER_TABLE);
    var w = thead.getBoundingClientRect().width;
    if (NS.BROWSER === 'ie11') w = Math.ceil(w);
    ptab.style.width = w + 'px';
    cont.appendChild(ptab);
    var clone = thead.cloneNode(true);
    ptab.appendChild(clone);
    var oTrs = thead.rows;
    var cTrs = clone.rows;

    for (var i = 0; i < oTrs.length; i += 1) {
      copyWidth(oTrs[i], cTrs[i], 'td');
      copyWidth(oTrs[i], cTrs[i], 'th');
    }

    function copyWidth(o, c, tag) {
      var os = o.getElementsByTagName(tag);
      var cs = c.getElementsByTagName(tag);

      for (var _i3 = 0; _i3 < os.length; _i3 += 1) {
        cs[_i3].style.width = os[_i3].getBoundingClientRect().width + 'px';
      }
    }

    if (NS.containStile(table, ST_STATE_ENLARGED)) NS.addStile(cont, ST_STATE_ENLARGED);
    return cont;
  }

  function createPseudoTableHeader(table) {
    var tbody = table.tBodies[0];
    var trs = tbody.rows;
    if (trs.length === 0) return null;

    function containsOnlyTh(tr) {
      var tds = tr.getElementsByTagName('td');
      var ths = tr.getElementsByTagName('th');
      if (tds.length === 0 && ths.length > 0) return true;
      return false;
    }

    var trsH = [];

    for (var i = 0, I = trs.length; i < I; i += 1) {
      var tr = trs[i];
      if (!containsOnlyTh(tr)) break;
      trsH.push(tr);
    }

    if (trsH.length === 0) return null;
    var thead = table.createTHead();

    for (var _i4 = 0; _i4 < trsH.length; _i4 += 1) {
      thead.appendChild(trsH[_i4]);
    }

    return thead;
  }

  function cloneTableScrollBar(table) {
    var tbody = table.tBodies[0];
    var bar = document.createElement('div');
    NS.addStile(bar, ST_SCROLL_BAR);
    bar.style.maxWidth = table.clientWidth + 'px';
    bar.style.display = 'none';
    var h = parseInt(getScrollBarWidth());
    if (0 < h) bar.style.height = h + 2 + 'px';
    table.parentNode.appendChild(bar);
    var spacer = document.createElement('div');
    spacer.style.width = Math.ceil(tbody.clientWidth) + 'px';
    spacer.style.height = '1px';
    bar.appendChild(spacer);
    return bar;
  }

  function windowResize(cont) {
    var tab = cont.table,
        head = cont.header,
        bar = cont.bar;
    if (cont.etb && NS.containStile(tab, ST_STATE_ENLARGED)) windowResize_enlarger(tab);

    if (head) {
      if (head.parentNode) head.parentNode.removeChild(head);
      cont.header = cloneTableHeader(tab);
    }

    if (bar) {
      if (bar.parentNode) bar.parentNode.removeChild(bar);
      cont.bar = cloneTableScrollBar(tab);
      initBarEvent(cont);
    }

    cont.calcWidth = cont.table.offsetWidth;
    if (cont.header || cont.bar) windowScroll(cont);
    tableScroll(cont);
  }

  function windowScroll(cont) {
    if (cont.calcWidth !== cont.table.offsetWidth) {
      windowResize(cont);
    }

    var tab = cont.table,
        head = cont.header,
        bar = cont.bar,
        cap = cont.cap;
    var winY = window.pageYOffset;
    var tabTop = tab.getBoundingClientRect().top + winY,
        tabBottom = tabTop + tab.offsetHeight;
    var capH = cap ? cap.offsetHeight : 0;
    var offset = getTableHeaderOffset() + NS.getWpAdminBarHeight() - capH;
    var isInWin = tab.offsetHeight < HEADER_FLOATING_WINDOW_HEIGHT_RATIO * (window.innerHeight - offset);
    var tabLeft = head || bar ? tab.getBoundingClientRect().left + 'px' : '';

    if (head) {
      if (isInWin) {
        head.style.display = 'none';
        if (cont.etb) switchEnlargerToTable(cont);
      } else if (winY + offset < tabTop || tabBottom - cont.headerHeight < winY + offset) {
        head.style.display = 'none';
        if (cont.etb) switchEnlargerToTable(cont);
      } else if (tabTop < winY + offset) {
        head.style.display = 'block';
        head.style.top = getTableHeaderOffset() + NS.getWpAdminBarHeight() + 'px';
        head.style.boxShadow = HEAD_BOTTOM_SHADOW;
        cont.headerHeight = head.getBoundingClientRect().height;
        if (cont.etb) switchEnlargerToFloatingHeader(cont);
      }

      head.style.left = tabLeft;
      head.scrollLeft = tab.scrollLeft;
    }

    if (bar) {
      if (isInWin) {
        bar.style.display = 'none';
      } else if (winY + window.innerHeight < tabTop || tabBottom < winY + window.innerHeight) {
        bar.style.display = 'none';
      } else if (tab.scrollWidth - tab.clientWidth > 1) {
        // for avoiding needless scrolling
        bar.style.display = 'block';
      }

      bar.style.left = tabLeft;
      bar.scrollLeft = tab.scrollLeft;
    }
  }

  function tableScroll(cont) {
    var tab = cont.table,
        head = cont.header,
        cap = cont.cap;
    if (head) head.scrollLeft = tab.scrollLeft;

    if (tab.scrollWidth - tab.clientWidth > 2) {
      // for avoiding needless scrolling
      var r = tab.scrollLeft / (tab.scrollWidth - tab.clientWidth);
      var rl = 0.15,
          rr = 0.15;
      if (r < 0.1) rl *= r / 0.1;
      if (0.9 < r) rr *= (1 - r) / 0.1;
      var shadow = '1.5rem 0 1.5rem -1rem rgba(0,0,0,' + rl + ') inset, -1.5rem 0 1.5rem -1rem rgba(0,0,0,' + rr + ') inset';
      tab.style.boxShadow = shadow;
      tab.style.overflowX = 'auto';
      if (head) head.style.boxShadow = shadow + ', ' + HEAD_BOTTOM_SHADOW;
      if (cap) cap.style.transform = 'translateX(' + tab.scrollLeft + 'px)';
    } else {
      tab.style.boxShadow = '';
      tab.style.overflowX = '';
      if (head) head.style.boxShadow = HEAD_BOTTOM_SHADOW;
      if (cap) cap.style.transform = null;
    }

    if (cont.etb) tableScroll_enlarger_wrap(cont);
  } // Enlarger ----------------------------------------------------------------


  function createEnlarger(table) {
    var etb = document.createElement('div');
    etb.dataset['stile'] = ST_ENLARGER_BUTTON;
    table.appendChild(etb);
    return etb;
  }

  function initEnlargerEvent(cont) {
    cont.etb.addEventListener('click', function () {
      enlarge(cont);
    });
  }

  function switchEnlargerToTable(cont) {
    cont.etb.parentNode.removeChild(cont.etb);
    cont.etb.style.top = cont.cap ? cont.cap.offsetHeight + 'px' : 0;
    cont.table.appendChild(cont.etb);
  }

  function switchEnlargerToFloatingHeader(cont) {
    cont.etb.parentNode.removeChild(cont.etb);
    cont.etb.style.top = 0;
    cont.header.appendChild(cont.etb);
  }

  function enlarge(cont) {
    var tab = cont.table;

    if (NS.containStile(tab, ST_STATE_ENLARGED)) {
      tab.style.marginLeft = '';
      tab.style.zIndex = '';
      tab.style.width = '';
      tab.style.maxWidth = '';
      NS.removeStile(tab, ST_STATE_ENLARGED);
    } else {
      if (tab.scrollWidth - tab.offsetWidth <= 1) return;
      tab.style.zIndex = '98';
      tab.style.width = 'calc(100vw - ' + scrollBarWidth + 'px)';
      tab.style.maxWidth = '100vw';
      tab.scrollLeft = 0;
      NS.addStile(tab, ST_STATE_ENLARGED);
    }

    windowResize(cont);
  }

  function windowResize_enlarger(tab) {
    var left = tab.getBoundingClientRect().left + window.pageXOffset;
    var tbody = tab.tBodies[0];
    var width = tbody.clientWidth,
        pwidth = window.innerWidth - scrollBarWidth;
    if (width < pwidth) left -= (pwidth - width) / 2;
    tab.style.marginLeft = -left + 'px';
  }

  function tableScroll_enlarger_wrap(cont) {
    var etb = cont.etb;
    NS.removeStile(etb, 'visible');
    if (cont.tse) clearTimeout(cont.tse);
    cont.tse = setTimeout(function () {
      NS.addStile(etb, 'visible');
    }, 200);
    tableScroll_enlarger(cont);
  }

  function tableScroll_enlarger(cont) {
    var tab = cont.table,
        etb = cont.etb,
        cap = cont.cap;
    var bodyW = tab.tBodies[0].clientWidth;

    if (tab.scrollWidth - tab.offsetWidth > 1 && tab.offsetWidth < ENLARGER_WINDOW_WIDTH_RATIO * window.innerWidth) {
      // for avoiding needless scrolling
      var pos = Math.min(bodyW - tab.offsetWidth, tab.scrollLeft); // for Mobile Safari

      etb.style.right = -pos + 'px';
      if (etb.parentNode === tab) etb.style.top = cap ? cap.offsetHeight + 'px' : 0;
      etb.style.display = 'block';
    } else {
      if (NS.containStile(tab, ST_STATE_ENLARGED)) {
        var diff = etb.parentElement.offsetWidth - bodyW;

        if (0 < diff) {
          etb.style.right = diff + 'px';
        } else {
          var _pos = Math.min(bodyW - tab.offsetWidth, tab.scrollLeft); // for Mobile Safari


          etb.style.right = -_pos + 'px';
        }

        if (etb.parentNode === tab) etb.style.top = cap ? cap.offsetHeight + 'px' : 0;
        etb.style.display = 'block';
      } else {
        etb.style.display = 'none';
      }
    }
  } // Utilities ---------------------------------------------------------------


  function getScrollBarWidth() {
    var dummy = document.createElement('div');
    dummy.style.bottom = '100%';
    dummy.style.height = '1px';
    dummy.style.position = 'absolute';
    dummy.style.width = 'calc(100vw - 100%)';
    document.body.appendChild(dummy);
    var width = 0 | window.getComputedStyle(dummy, '').getPropertyValue('width');

    if (width === 0) {
      // Window does not have any scroll bar
      dummy.style.overflowY = 'scroll';
      dummy.style.width = '';
      var c = document.createElement('div');
      c.style.minHeight = '100px';
      dummy.appendChild(c);
      var cw = 0 | window.getComputedStyle(c, '').getPropertyValue('width');
      width = dummy.offsetWidth - cw;
    }

    document.body.removeChild(dummy);
    return width;
  }
})(window.ST);
"use strict";

/**
 *
 * Table Style - Neat Wrap (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-07
 *
 */
window.ST = window['ST'] || {};

(function (NS) {
  var SEL_TARGET = '.stile';
  var ST_OPT_NO_NEAT_WRAP = 'no-neat-wrap';
  var CELL_MIN_WIDTH = 120;
  var CELL_MIN_WIDTH_RATE = 0.15;
  var CELL_MIN_RATIO = 2 / 3; // width : height

  var MAX_ROW_COUNT = 200;
  var IS_COMPAT_MODE = NS.BROWSER === 'ie11';
  NS.addInitializer(4, function () {
    var tabs = document.querySelectorAll(SEL_TARGET + ' table:not([class])');
    setTimeout(function () {
      initialize(tabs);
    }, 0);
  }); // -------------------------------------------------------------------------

  function initialize(tabs) {
    var tabsFlt = [];

    for (var i = 0; i < tabs.length; i += 1) {
      if (!NS.containStile(tabs[i], ST_OPT_NO_NEAT_WRAP)) tabsFlt.push(tabs[i]);
    }

    var lt = tabsFlt[tabsFlt.length - 1];
    var d = createDummyCell(lt);

    for (var _i = 0, _tabsFlt = tabsFlt; _i < _tabsFlt.length; _i++) {
      var t = _tabsFlt[_i];
      apply(t, d);
    }

    lt.removeChild(d);
  }

  function createDummyCell(table) {
    var dummy = document.createElement('td');
    dummy.style.display = 'inline-block';
    dummy.style.position = 'fixed';
    dummy.style.visibility = 'hidden';
    table.appendChild(dummy);
    return dummy;
  }

  function apply(table, dummyCell) {
    if (table.getAttribute('width') != null) table.setAttribute('width', '');
    table.style.maxWidth = '';
    var tbody = table.tBodies[0];
    if (tbody.clientWidth <= table.clientWidth) return;
    if (MAX_ROW_COUNT < countRows(table)) return;
    var grid = makeCellGrid(table);
    if (grid.length === 0) return;
    var newWs = [];

    for (var x = 0; x < grid[0].length; x += 1) {
      newWs.push(false);
    }

    var data = collectMetrix(table, grid);

    if (IS_COMPAT_MODE) {
      calcNewWidthes_simply(grid, data, newWs);
    } else {
      calcNewWidthes(grid, data, newWs, dummyCell);
    }

    setCellWidth(grid, newWs);
  }

  function countRows(table) {
    var thead = table.tHead;
    var tbody = table.tBodies[0];
    var tfoot = table.tFoot;
    var count = 0;
    if (thead) count += thead.rows.length;
    if (tbody) count += tbody.rows.length;
    if (tfoot) count += tfoot.rows.length;
    return count;
  }

  function collectMetrix(table, grid) {
    var td = table.getElementsByTagName('td')[0];
    var s = getComputedStyle(td);
    var padH = parseFloat(s.paddingLeft) + parseFloat(s.paddingRight);
    var padV = parseFloat(s.paddingTop) + parseFloat(s.paddingBottom);
    var lineHeight = parseFloat(s.lineHeight);
    var origTableWidth = table.clientWidth;
    var cellMinWidth = Math.max(CELL_MIN_WIDTH, origTableWidth * CELL_MIN_WIDTH_RATE);
    var origCellWidths = [];

    for (var x = 0; x < grid[0].length; x += 1) {
      origCellWidths.push(grid[0][x].clientWidth);
    }

    return {
      padH: padH,
      padV: padV,
      lineHeight: lineHeight,
      origTableWidth: origTableWidth,
      origCellWidths: origCellWidths,
      cellMinWidth: cellMinWidth
    };
  }

  function setCellWidth(grid, ws) {
    for (var y = 0; y < grid.length; y += 1) {
      var gridRow = grid[y];

      for (var x = 0; x < gridRow.length; x += 1) {
        var td = gridRow[x],
            w = ws[x];
        if (td === undefined || td === null || typeof td === 'number' || w === false) continue;
        td.style.whiteSpace = 'normal';
        td.style.minWidth = w + 'px';
        td.style.width = '';
      }
    }
  } // -------------------------------------------------------------------------


  function makeCellGrid(table) {
    var thead = table.tHead;
    var tbody = table.tBodies[0];
    var tfoot = table.tFoot;
    var cells = [];
    if (thead) addCells(thead.rows, cells);
    if (tbody) addCells(tbody.rows, cells);
    if (tfoot) addCells(tfoot.rows, cells);
    var maxWidth = 0,
        tab = [];

    for (var i = 0; i < cells.length; i += 1) {
      var w = cells[i].length;
      if (maxWidth < w) maxWidth = w;
    }

    for (var _i2 = 0; _i2 < cells.length; _i2 += 1) {
      var a = [];
      a.length = maxWidth;
      tab.push(a);
    }

    for (var y = 0; y < tab.length; y += 1) {
      var row = tab[y];
      var tds = cells[y];
      var _i3 = 0;

      for (var x = 0; x < maxWidth; x += 1) {
        if (typeof row[x] === 'number' || row[x] === null) continue;
        var td = tds[_i3];
        var colSpan = td.getAttribute('colSpan') | 1;
        var rowSpan = td.getAttribute('rowSpan');
        row[x] = td;

        if (1 < colSpan) {
          for (var p = 1; p < colSpan; p += 1) {
            row[x + p] = p;
          }
        }

        if (1 < rowSpan) {
          for (var q = 1; q < rowSpan; q += 1) {
            var nr = tab[y + q];

            for (var _p = 0; _p < colSpan; _p += 1) {
              nr[x + _p] = null;
            }
          }
        }

        _i3 += 1;
        if (tds.length <= _i3) break;
      }
    }

    return tab;
  }

  function addCells(trs, cells) {
    for (var i = 0; i < trs.length; i += 1) {
      var tr = trs[i],
          row = [];

      if (tr.hasChildNodes()) {
        var cns = tr.childNodes;

        for (var j = 0; j < cns.length; j += 1) {
          var cn = cns[j],
              tn = cn.tagName;
          if (tn === 'TD' || tn === 'TH') row.push(cn);
        }
      }

      cells.push(row);
    }
  } // -------------------------------------------------------------------------


  function calcNewWidthes_simply(grid, data, newWs) {
    var origWs = [].concat(newWs);

    for (var y = 0; y < grid.length; y += 1) {
      var gridRow = grid[y];

      for (var x = 0; x < gridRow.length; x += 1) {
        if (newWs[x] !== false) continue;
        var td = gridRow[x];
        if (td === null || typeof td === 'number') continue;
        if (x < gridRow.length - 1 && typeof gridRow[x + 1] === 'number') continue;
        var aw = td.clientWidth - data.padH;
        var l = td.getElementsByTagName('br').length + 1;
        origWs[x] = aw;
        var minW = 0;

        for (var i = 2;; i += 1) {
          var tempW = aw / i + data.padH;
          var tempH = l * (i * data.lineHeight) + data.padV;
          if (tempW < CELL_MIN_WIDTH || tempW / tempH < CELL_MIN_RATIO) break;
          minW = tempW;
        }

        if (minW) newWs[x] = Math.max(newWs[x], minW);
      }
    }

    widenTableWidth_simply(newWs, origWs, data.origTableWidth);
  }

  function widenTableWidth_simply(newWs, origWs, widthOrig) {
    var widthNew = 0;

    for (var i = 0; i < newWs.length; i += 1) {
      if (newWs[i] === false) return;
      widthNew += newWs[i];
    }

    if (widthNew >= widthOrig) return;
    var keepAws = [];

    for (var _i4 = 0; _i4 < newWs.length; _i4 += 1) {
      var rw = newWs[_i4] / widthNew * widthOrig;
      keepAws.push(origWs[_i4] < rw);
    }

    for (var _i5 = 0; _i5 < newWs.length; _i5 += 1) {
      if (keepAws[_i5]) {
        widthNew -= newWs[_i5];
        widthOrig -= origWs[_i5];
        newWs[_i5] = origWs[_i5];
      }
    }

    for (var _i6 = 0; _i6 < newWs.length; _i6 += 1) {
      if (!keepAws[_i6]) newWs[_i6] = newWs[_i6] / widthNew * widthOrig;
    }
  } // -------------------------------------------------------------------------


  function calcNewWidthes(grid, data, newWs, dummy) {
    var wrapped = [];

    for (var y = 0; y < grid.length; y += 1) {
      var gridRow = grid[y];

      for (var x = 0; x < gridRow.length; x += 1) {
        wrapped[x] = false;
        var td = gridRow[x];
        if (td === undefined || td === null || typeof td === 'number') continue;
        if (x < gridRow.length - 1 && typeof gridRow[x + 1] === 'number') continue;
        td.innerHTML = td.innerHTML.trim(); // trim!!

        dummy.innerHTML = td.innerHTML + 'm'; // for adding error factor

        var aw = dummy.clientWidth - data.padH;
        var l = Math.round((dummy.clientHeight - data.padV) / data.lineHeight);
        var minW = 0;

        for (var i = 1;; i += 1) {
          var tempW = aw / i + data.padH;
          var tempH = l * (i * data.lineHeight) + data.padV;
          if (tempW < data.cellMinWidth || tempW / tempH < CELL_MIN_RATIO) break;
          if (1 < i) wrapped[x] = true;
          minW = tempW;
        }

        if (minW) newWs[x] = Math.max(newWs[x], minW);
      }
    }

    widenTableWidth(newWs, wrapped, data);
  }

  function widenTableWidth(newWs, wrapped, data) {
    var widthNew = 0,
        widthFix = 0;

    for (var i = 0; i < newWs.length; i += 1) {
      if (newWs[i] === false) return;

      if (wrapped[i]) {
        widthNew += newWs[i];
      } else {
        widthFix += newWs[i];
      }
    }

    if (widthNew + widthFix < data.origTableWidth) {
      var realloc = data.origTableWidth - widthFix;

      for (var _i7 = 0; _i7 < newWs.length; _i7 += 1) {
        if (wrapped[_i7]) {
          var w = newWs[_i7] / widthNew * realloc;
          w = Math.min(w, data.origCellWidths[_i7]);
          realloc -= w - newWs[_i7];
          widthNew -= w - newWs[_i7];
          newWs[_i7] = w;
        }
      }
    }
  }
})(window.ST);
"use strict";

/**
 *
 * Alignment Classes (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-06
 *
 */
window.ST = window['ST'] || {};
ST.addInitializer(1, function () {
  var TARGET_SELECTOR = '.stile';
  var WIDTH_MIN = 240; // px

  var PERMITTED_CLASSES = ['alignleft', 'aligncenter', 'alignright', 'size-thumbnail', 'size-small', 'size-medium-small', 'size-medium', 'size-medium-large', 'size-medium_large', 'size-large', 'size-full'];
  var als = document.querySelectorAll(TARGET_SELECTOR + ' .alignleft');
  var ars = document.querySelectorAll(TARGET_SELECTOR + ' .alignright');
  var acs = document.querySelectorAll(TARGET_SELECTOR + ' .aligncenter');
  als = replaceAlignClass(als);
  ars = replaceAlignClass(ars);
  replaceAlignClass(acs);
  if (ST.BROWSER === 'ie11') return;
  setTimeout(function () {
    modifyAlignmentStyle(als, 'alignleft');
    modifyAlignmentStyle(ars, 'alignright');
  }, 0); // Delay
  // -------------------------------------------------------------------------

  function modifyAlignmentStyle(as, stile) {
    var asw = initTargets(as);
    assignWidths(asw, stile);
    ST.onResize(function () {
      updateApplicableWidths(asw);
      switchFloat(asw, stile);
    });
    ST.onScroll(function () {
      assignWidths(asw, stile);
    }); // for Lazy Image Loading

    updateApplicableWidths(asw);
    switchFloat(asw, stile);
  }

  function initTargets(as) {
    var asw = [];

    for (var i = 0; i < as.length; i += 1) {
      asw.push([as[i], 0]);
    }

    return asw;
  }

  function assignWidths(asw, stile) {
    for (var i = 0; i < asw.length; i += 1) {
      var a = asw[i][0],
          w = asw[i][1];
      if (10 < w) continue;
      ST.addStile(a, stile);
      var nw = a.getBoundingClientRect().width;
      ST.removeStile(a, stile);
      asw[i][1] = nw;
    }

    return asw;
  }

  function updateApplicableWidths(asw) {
    for (var i = 0; i < asw.length; i += 1) {
      var a = asw[i][0],
          w = asw[i][1];
      var pw = contentWidth(a.parentElement);
      var nw = a.getBoundingClientRect().width;
      if (nw < pw * 0.9 && w < nw) asw[i][1] = nw;
    }
  }

  function switchFloat(asw, stile) {
    for (var i = 0; i < asw.length; i += 1) {
      var a = asw[i][0],
          w = asw[i][1];
      var pw = contentWidth(a.parentElement, true);

      if (pw - w < WIDTH_MIN) {
        ST.removeStile(a, stile);
        ST.addStile(a, 'aligncenter');
      } else {
        ST.removeStile(a, 'aligncenter');
        ST.addStile(a, stile);
      }
    }
  }

  function contentWidth(elm) {
    var checkDisplay = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var style = getComputedStyle(elm);
    if (checkDisplay && style.display === 'inline') return contentWidth(elm.parentElement);
    var padH = parseFloat(style.paddingLeft) + parseFloat(style.paddingRight);
    return elm.clientWidth - padH;
  } // -------------------------------------------------------------------------


  function replaceAlignClass(ts) {
    var ret = [];

    for (var i = 0; i < ts.length; i += 1) {
      var c = ts[i];
      var p = c.parentNode;
      var replace = false;

      if (p.tagName === 'A' && isImageLink(p)) {
        if (moveClass(c, p, 'alignleft')) replace = true;
        if (moveClass(c, p, 'aligncenter')) replace = true;
        if (moveClass(c, p, 'alignright')) replace = true;
      }

      ret.push(replace ? p : c);
    }

    return ret;
  }

  function moveClass(c, p, cls) {
    if (c.classList.contains(cls)) {
      c.classList.remove(cls);
      p.classList.add(cls);
      return true;
    }

    return false;
  }

  function isImageLink(a) {
    if (a.className) {
      var _cs = a.className.split(' ');

      for (var i = 0; i < _cs.length; i += 1) {
        if (PERMITTED_CLASSES.indexOf(_cs[i]) === -1) return false;
      }
    }

    var cs = a.childNodes;
    if (cs.length === 0) return false;
    var success = false;

    for (var _i = 0; _i < cs.length; _i += 1) {
      var tn = cs[_i].tagName;

      if (success === false && tn === 'IMG') {
        success = true;
        continue;
      }

      if (tn) return false;
    }

    return success;
  }
});
"use strict";

/**
 *
 * Container Classes (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-02-02
 *
 */
window.ST = window['ST'] || {};
ST.addInitializer(1, function () {
  var TARGET_SELECTOR = '.stile';
  var cs = document.querySelectorAll(TARGET_SELECTOR + ' .card-3');

  for (var i = 0; i < cs.length; i += 1) {
    modifyCardStyle(cs[i], 3);
  }

  cs = document.querySelectorAll(TARGET_SELECTOR + ' .card-4');

  for (var _i = 0; _i < cs.length; _i += 1) {
    modifyCardStyle(cs[_i], 4);
  } // -------------------------------------------------------------------------
  // Card


  function modifyCardStyle(a, col) {
    var cs = a.childNodes;
    if (cs.length === 0) return false;
    var parentTN = a.tagName;
    var childTN = 'DIV';

    switch (parentTN) {
      case 'UL':
      case 'OL':
        childTN = 'LI';
    }

    for (var _i2 = 0; _i2 < col - 1; _i2 += 1) {
      var e = document.createElement(childTN);
      a.appendChild(e);
    }

    return true;
  }
});
"use strict";

/**
 *
 * Image Box (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-04-03
 *
 */
window.ST = window['ST'] || {};
ST.addInitializer(7, function () {
  var WIN_SIZE_RESPONSIVE = 600;
  var TARGET_SELECTOR = '.stile';
  var TARGET_SELECTOR_IMAGE_BOX = '.stile-image-box';
  var STILE_CLS_IMAGE_BOX = 'image-box';
  var STILE_STATE_OPEN = 'open';
  var STILE_STATE_VISIBLE = 'visible';
  var SIZE_BOX_PADDING = '4rem';
  var as = document.querySelectorAll(TARGET_SELECTOR + ' a');
  modifyImageAnchorStyle(as);
  as = document.querySelectorAll(TARGET_SELECTOR_IMAGE_BOX + ' a');
  modifyImageAnchorStyle(as);

  function modifyImageAnchorStyle(as) {
    var fas = filterImageLink(as);

    for (var i = 0; i < fas.length; i += 1) {
      createBox(fas[i]);
    }
  }

  function filterImageLink(as) {
    var ret = [];

    for (var i = 0; i < as.length; i += 1) {
      var a = as[i];
      if (!ST.containStile(a, 'link-image')) continue;
      var href = a.href;
      if (!href || !isImageUrl(href)) continue;
      var imgs = a.getElementsByTagName('img');
      if (imgs.length === 0) continue;
      var img = imgs[0];
      var src = img.dataset.src ? img.dataset.src : img.src;
      if (!src || !isImageUrl(src)) continue;
      ret.push(a);
    }

    return ret;
  }

  function isImageUrl(url) {
    url = url.split('?')[0];
    url = url.toLowerCase();
    var ss = url.split('.');
    var ext = ss[ss.length - 1];

    switch (ext) {
      case 'jpeg':
      case 'jpg':
      case 'png':
      case 'gif':
        return true;
    }

    return false;
  }

  function createBox(a) {
    var frame = document.createElement('div');
    ST.addStile(frame, STILE_CLS_IMAGE_BOX);
    var img = document.createElement('img');
    img.src = a.href;
    frame.appendChild(img);
    var closeBtn = document.createElement('span');
    frame.appendChild(closeBtn);
    document.body.appendChild(frame);
    a.addEventListener('click', function (e) {
      onOpen(e, frame, img);
    });
    frame.addEventListener('click', function (e) {
      onClose(e, frame);
    });
    enableTouchGesture(frame, img);
    img.addEventListener('click', function (e) {
      e.stopPropagation();
    });
    frame.addEventListener('mousewheel', function (e) {
      e.preventDefault();
    });
    return frame;
  }

  function onOpen(e, frame, img) {
    e.preventDefault();
    ST.addStile(frame, STILE_STATE_OPEN);
    var isPhone = window.innerWidth < WIN_SIZE_RESPONSIVE;

    if (checkLandscape(frame, img)) {
      img.style.minWidth = '';
      img.style.width = isPhone ? '100%' : 'calc(100% - ' + SIZE_BOX_PADDING + ')';
      img.style.height = 'auto';
    } else {
      img.style.minHeight = '';
      img.style.width = 'auto';
      img.style.maxWidth = 'none';
      img.style.height = isPhone ? '100%' : 'calc(100% - ' + SIZE_BOX_PADDING + ')';
    }

    centeringImage(frame, img);
    var delay = ST.BROWSER === 'ie11' ? 30 : 0;
    setTimeout(function () {
      ST.addStile(frame, STILE_STATE_VISIBLE);
    }, delay);
  }

  function onClose(e, frame) {
    e.preventDefault();
    ST.removeStile(frame, STILE_STATE_VISIBLE);
    setTimeout(function () {
      ST.removeStile(frame, STILE_STATE_OPEN);
    }, 200);
  }

  function enableTouchGesture(frame, img) {
    var isLandscape = true;
    var baseDist = 0;
    var scale = 1;
    var tid;
    var xS = 0,
        yS = 0;
    var isMoving = false;
    frame.addEventListener('touchstart', function (e) {
      isLandscape = checkLandscape(frame, img);
      baseDist = 0;
      if (!img.style.minWidth && !img.style.minHeight) scale = 1;

      if (e.touches.length === 1) {
        isMoving = true;
        xS = e.touches[0].screenX + frame.scrollLeft;
        yS = e.touches[0].screenY + frame.scrollTop;
      }
    }, true);
    frame.addEventListener('touchmove', function (e) {
      e.stopPropagation();
      e.preventDefault();
      frame.style.overflow = 'scroll';
      var ts = e.changedTouches;

      if (ts.length === 1 && isMoving) {
        frame.scrollLeft = xS - ts[0].screenX;
        frame.scrollTop = yS - ts[0].screenY;
      } else if (ts.length > 1) {
        isMoving = false;
        var baseSize = isLandscape ? frame.clientWidth : frame.clientHeight;
        var dist = touchDistance(ts);
        var scx = (ts[0].screenX + ts[1].screenX) / 2;
        var scy = (ts[0].screenY + ts[1].screenY) / 2;
        var imgCx = (scx + frame.scrollLeft) / scale;
        var imgCy = (scy + frame.scrollTop) / scale;
        clearTimeout(tid);

        if (baseDist) {
          var s = dist / (baseDist * scale);

          if (s && s !== Infinity) {
            scale *= s;
            scale = Math.min(4, scale);
            scale = Math.max(1, scale);

            if (isLandscape) {
              img.style.minWidth = baseSize * scale + 'px';
            } else {
              img.style.minHeight = baseSize * scale + 'px';
            }

            centeringImage(frame, img);
            frame.scrollLeft = imgCx * scale - scx;
            frame.scrollTop = imgCy * scale - scy;
          }

          tid = setTimeout(function () {
            baseDist = 0;
          }, 100);
        } else {
          baseDist = dist / scale;
        }
      }
    }, true);
  }

  function checkLandscape(frame, img) {
    var winAspect = frame.offsetWidth / frame.offsetHeight;
    var imgAspect = img.offsetWidth / img.offsetHeight;
    return winAspect < imgAspect;
  }

  function centeringImage(frame, img) {
    if (img.offsetWidth < frame.offsetWidth) {
      img.style.left = (frame.offsetWidth - img.offsetWidth) / 2 + 'px';
    } else {
      img.style.left = 0;
    }

    if (img.offsetHeight < frame.offsetHeight) {
      img.style.top = (frame.offsetHeight - img.offsetHeight) / 2 + 'px';
    } else {
      img.style.top = 0;
    }
  }

  function touchDistance(ts) {
    var x1 = ts[0].screenX;
    var y1 = ts[0].screenY;
    var x2 = ts[1].screenX;
    var y2 = ts[1].screenY;
    return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
  }
});
"use strict";

/**
 *
 * Pseudo Tab Page Classes (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-07
 *
 */
window.ST = window['ST'] || {};
ST.addInitializer(3, function () {
  var SELECTOR_TARGET = '.pseudo-tab-page';
  var CLS_TAB_LIST = 'stile-pseudo-tab-page-tab-list';
  var ID_TAB_LIST_ID_BASE = '';
  var ST_STATE_CURRENT = 'current';
  var SINGLE_TAB = true;
  var tabUlss = [];
  var tps = document.querySelectorAll(SELECTOR_TARGET);

  for (var i = 0; i < tps.length; i += 1) {
    var tabUls = createTabPage(tps[i], i);
    if (tabUls !== false) tabUlss.push(tabUls);
  }

  if (SINGLE_TAB) initializeSingleTab();

  function createTabPage(container, idx) {
    var fh = getFirstHeading(container);
    if (!fh) return false;
    var tabH = fh.tagName;
    var cs = [].slice.call(container.children);
    var hs = [];
    var htmls = [];

    for (var _i = 0; _i < cs.length; _i += 1) {
      var c = cs[_i];

      if (c.tagName === tabH) {
        hs.push(c);
        htmls.push(c.innerHTML);
      }
    }

    var tabUls = [];

    for (var _i2 = 0; _i2 < hs.length; _i2 += 1) {
      var tp = createTab(htmls, _i2, idx, tabUls);
      container.insertBefore(tp.tabUl, hs[_i2]);
      tabUls.push(tp.tabUl);
    }

    if (ST.assignAnchorOffset) ST.assignAnchorOffset(tabUls);
    return tabUls;
  }

  function createTab(htmls, tabIdx, contIdx, tabUls) {
    var tp = {};
    tp.tabUl = document.createElement('ul');
    tp.tabUl.id = ID_TAB_LIST_ID_BASE + contIdx + '-' + tabIdx;
    tp.tabUl.className = CLS_TAB_LIST;
    tp.tabUl.classList.add('stile-link-target');
    tp.tabAs = [];
    var ios = document.body.classList.contains('ios');

    var _loop = function _loop(_i3) {
      var li = document.createElement('li');
      var tc = document.createElement('a');
      tc.href = '#' + ID_TAB_LIST_ID_BASE + contIdx + '-' + _i3;
      tc.innerHTML = htmls[_i3];
      tc.dataset['stile'] = ios ? 'no-anchor-scroll' : 'anchor-scroll-fast';
      if (SINGLE_TAB) tc.addEventListener('click', function () {
        onTabClick(_i3, tabUls);
      });
      li.appendChild(tc);
      tp.tabUl.appendChild(li);
      tp.tabAs.push(tc);
    };

    for (var _i3 = 0; _i3 < htmls.length; _i3 += 1) {
      _loop(_i3);
    }

    ST.addStile(tp.tabUl.children[tabIdx], ST_STATE_CURRENT);
    if (SINGLE_TAB) ST.addStile(tp.tabUl, 'hidden');
    return tp;
  }

  function getFirstHeading(container) {
    var cs = container.children;

    for (var _i4 = 0; _i4 < cs.length; _i4 += 1) {
      var tn = cs[_i4].tagName;

      if (tn[0] === 'H' && (tn[1] === '1' || tn[1] === '2' || tn[1] === '3' || tn[1] === '4' || tn[1] === '5' || tn[1] === '6')) {
        return cs[_i4];
      }
    }

    return null;
  } // -------------------------------------------------------------------------


  function initializeSingleTab() {
    updateVisibility(tabUlss, true);
    ST.onScroll(function () {
      updateVisibility(tabUlss);
    });
  }

  function onTabClick(idx, tabUls) {
    showImmediately(tabUls[idx]);
    setTimeout(function () {
      updateVisibility(tabUlss, true);
    }, 10);
  }

  function updateVisibility(tabUlss) {
    var immediately = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

    if (immediately) {
      for (var _i5 = 0; _i5 < tabUlss.length; _i5 += 1) {
        var _tabUls = tabUlss[_i5];

        for (var j = 0; j < _tabUls.length; j += 1) {
          ST.addStile(_tabUls[j], 'immediately');
        }
      }
    }

    for (var _i6 = 0; _i6 < tabUlss.length; _i6 += 1) {
      var _tabUls2 = tabUlss[_i6];
      var shown = false;

      for (var _j = 0; _j < _tabUls2.length; _j += 1) {
        var tabUl = _tabUls2[_j];
        var y = tabUl.getBoundingClientRect().top;

        if (0 < y && !shown) {
          shown = true;
          ST.removeStile(tabUl, 'hidden');
        } else if (shown) {
          ST.addStile(tabUl, 'hidden');
        }
      }
    }

    if (immediately) {
      setTimeout(function () {
        for (var _i7 = 0; _i7 < tabUlss.length; _i7 += 1) {
          var _tabUls3 = tabUlss[_i7];

          for (var _j2 = 0; _j2 < _tabUls3.length; _j2 += 1) {
            ST.removeStile(_tabUls3[_j2], 'immediately');
          }
        }
      }, 1000);
    }
  }

  function showImmediately(tabUl) {
    ST.addStile(tabUl, 'immediately');
    ST.removeStile(tabUl, 'hidden');
    setTimeout(function () {
      ST.removeStile(tabUl, 'immediately');
    }, 1000);
  }
});
"use strict";

/**
 *
 * Tab Page Classes (JS)
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-06-06
 *
 */
window.ST = window['ST'] || {};
ST.addInitializer(3, function () {
  var SELECTOR_TARGET = '.tab-page';
  var CLS_TAB_LIST = 'stile-tab-page-tab-list';
  var CLS_TAB_LIST_BELOW = 'stile-tab-page-tab-list-below';
  var ST_STATE_CURRENT = 'current';
  var PAGE_HEIGHT_WINDOW_HEIGHT_RATIO = 0.8;
  var tabPages = [];
  var tps = document.querySelectorAll(SELECTOR_TARGET);

  for (var i = 0; i < tps.length; i += 1) {
    var tabPage = createTabPage(tps[i]);
    if (tabPage) tabPages.push(tabPage);
  }

  ST.onResize(function () {
    onResize(tabPages);
  });
  setTimeout(function () {
    onResize(tabPages);
  }, 200); // Delay

  initializeSmoothScroll();

  function createTabPage(container) {
    var fh = getFirstHeading(container);
    if (!fh) return false;
    var tabH = fh.tagName;
    var pages = [],
        htmls = [];
    var cs = [].slice.call(container.children);
    var curPage = null;

    for (var _i = 0; _i < cs.length; _i += 1) {
      var c = cs[_i];

      if (c.tagName === tabH) {
        if (curPage) pages.push(curPage);
        curPage = document.createElement('div');
        container.removeChild(c);
        htmls.push(c.innerHTML);
      } else {
        if (curPage) curPage.appendChild(c);
      }
    }

    if (curPage) pages.push(curPage);
    var tp = {
      pages: pages,
      container: container,
      currentIdx: 0,
      isAccordion: false
    };
    createTab(htmls, tp);
    container.insertBefore(tp.tabUl, container.firstChild);

    for (var _i2 = 0; _i2 < pages.length; _i2 += 1) {
      container.appendChild(pages[_i2]);
    }

    container.appendChild(tp.tabUl2);
    return tp;
  }

  function createTab(htmls, tp) {
    tp.tabUl = document.createElement('ul');

    for (var _i3 = 0; _i3 < htmls.length; _i3 += 1) {
      var li = document.createElement('li');
      li.innerHTML = htmls[_i3];
      tp.tabUl.appendChild(li);
    }

    tp.tabUl.className = CLS_TAB_LIST;
    tp.tabs = [].slice.call(tp.tabUl.children);
    tp.tabUl2 = tp.tabUl.cloneNode(true);
    tp.tabUl2.className = CLS_TAB_LIST_BELOW;
    tp.tabs2 = [].slice.call(tp.tabUl2.children);
    addTabEvent(tp);
    setTimeout(function () {
      tp.isAccordion = getComputedStyle(tp.tabUl2).flexDirection === 'column';
      onTabClick(tp, tp.isAccordion ? -1 : 0);
    }, 10);
  }

  function getFirstHeading(container) {
    var cs = container.children;

    for (var _i4 = 0; _i4 < cs.length; _i4 += 1) {
      var tn = cs[_i4].tagName;

      if (tn[0] === 'H' && (tn[1] === '1' || tn[1] === '2' || tn[1] === '3' || tn[1] === '4' || tn[1] === '5' || tn[1] === '6')) {
        return cs[_i4];
      }
    }

    return null;
  }

  function addTabEvent(tp) {
    var ts = tp.tabs,
        ts2 = tp.tabs2;

    for (var _i5 = 0; _i5 < ts.length; _i5 += 1) {
      var f = function (idx) {
        return function (e) {
          e.preventDefault();
          onTabClick(tp, idx);
          if (!tp.isAccordion) onResizeOne(tp, true);
        };
      }(_i5);

      ts[_i5].addEventListener('click', f);

      ts2[_i5].addEventListener('click', f);
    }
  }

  function onTabClick(tp, idx) {
    if (tp.isAccordion) {
      idx = tp.currentIdx === idx ? -1 : idx;
      updateAccordionTabState(tp, idx);
    }

    changeCurrentTab(tp, idx);
  }

  function changeCurrentTab(tp, idx) {
    var ts = tp.tabs,
        ts2 = tp.tabs2;
    var ps = tp.pages;
    var bcrOrig = tp.tabUl2.getBoundingClientRect();

    for (var _i6 = 0; _i6 < ts.length; _i6 += 1) {
      if (_i6 === idx) {
        ST.addStile(ts[_i6], ST_STATE_CURRENT);
        ST.addStile(ts2[_i6], ST_STATE_CURRENT);
        ST.addStile(ps[_i6], ST_STATE_CURRENT);
      } else {
        ST.removeStile(ts[_i6], ST_STATE_CURRENT);
        ST.removeStile(ts2[_i6], ST_STATE_CURRENT);
        ST.removeStile(ps[_i6], ST_STATE_CURRENT);
      }

      ts[_i6].className = '';
      ts2[_i6].className = '';
      ps[_i6].className = '';
    }

    tp.currentIdx = idx;
    if (idx === -1) return;
    setTimeout(function () {
      var bcr = tp.tabUl2.getBoundingClientRect();
      if (bcr.top < 0) jump(bcr.top - bcrOrig.top, 200);
    }, 10);
  }

  function updateAccordionTabState(tp, idx) {
    var ts = tp.tabs,
        ts2 = tp.tabs2;

    if (idx === -1) {
      for (var _i7 = 0; _i7 < ts.length; _i7 += 1) {
        ts[_i7].style.display = '';
        ts2[_i7].style.display = 'none';
      }
    } else {
      for (var _i8 = 0; _i8 < ts.length; _i8 += 1) {
        ts[_i8].style.display = _i8 <= idx ? '' : 'none';
        ts2[_i8].style.display = _i8 > idx ? 'flex' : 'none';
      }
    }
  }

  function onResize(tps) {
    for (var _i9 = 0; _i9 < tps.length; _i9 += 1) {
      onResizeOne(tps[_i9]);
    }
  }

  function onResizeOne(tp) {
    var suppressTabClick = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var cont = tp.container;
    var prevIsAccordion = tp.isAccordion;
    tp.isAccordion = getComputedStyle(tp.tabUl2).flexDirection === 'column';

    if (tp.isAccordion) {
      cont.style.minHeight = '';
      cont.style.height = '';
      if (prevIsAccordion !== tp.isAccordion) changeCurrentTab(tp, -1);
      updateAccordionTabState(tp, tp.currentIdx);
    } else {
      var minH = getMinHeight(tp);

      if (minH < window.innerHeight * PAGE_HEIGHT_WINDOW_HEIGHT_RATIO) {
        cont.style.minHeight = minH + 'px';
        cont.style.height = minH + 'px';
      } else {
        cont.style.minHeight = '';
        cont.style.height = '';
      }

      var ts = tp.tabs,
          ts2 = tp.tabs2;

      for (var _i10 = 0; _i10 < ts.length; _i10 += 1) {
        ts[_i10].style.display = '';
        ts2[_i10].style.display = '';
      }

      if (tp.currentIdx === -1) tp.currentIdx = 0;
      if (!suppressTabClick) onTabClick(tp, tp.currentIdx);
    }
  }

  function getMinHeight(tp) {
    var tabUl = tp.tabUl;
    var tabUl2 = tp.tabUl2;
    var pages = tp.pages;
    var marginBtm = parseInt(getComputedStyle(tabUl).marginBottom);
    var marginTop = parseInt(getComputedStyle(tabUl2).marginTop);
    var height = 0;

    for (var _i11 = 0; _i11 < pages.length; _i11 += 1) {
      var p = pages[_i11];
      var ps = getComputedStyle(p);
      var mt = parseInt(ps.marginTop);
      var mb = parseInt(ps.marginBottom);
      var h = p.getBoundingClientRect().height;
      marginBtm = Math.max(marginBtm, mt);
      marginTop = Math.max(marginTop, mb);
      height = Math.max(height, h);
    }

    return tabUl.offsetHeight + tabUl2.offsetHeight + marginBtm + marginTop + height;
  } // -------------------------------------------------------------------------


  var isJumping = false;

  function initializeSmoothScroll() {
    document.addEventListener('wheel', function () {
      isJumping = false;
    });
  }

  function jump(offset, duration) {
    var start = window.pageYOffset;
    var posY = start + offset;
    var timeStart, timeElapsed;
    isJumping = true;
    requestAnimationFrame(function (time) {
      timeStart = time;
      loop(time);
    });

    function loop(time) {
      if (!isJumping) return;
      timeElapsed = time - timeStart;
      window.scrollTo(0, easing(timeElapsed, start, posY, duration));
      if (timeElapsed < duration) requestAnimationFrame(loop);else end();
    }

    function end() {
      window.scrollTo(0, posY);
      setTimeout(function () {
        window.scrollTo(0, posY);
      }, 50);
      isJumping = false;
    }

    function easing(t, b, c, d) {
      t /= d / 2;
      if (t < 1) return (c - b) / 2 * t * t + b;
      t--;
      return -(c - b) / 2 * (t * (t - 2) - 1) + b;
    }
  }
});
"use strict";

/**
 *
 * Kerning
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-03-29
 *
 */
window.ST = window['ST'] || {};
ST.addInitializer(7, function () {
  var TARGET_SELECTOR = '.stile';
  var TARGET_SELECTOR_KERNING = '.stile-kerning';
  var ST_NO_KERNING = 'no-kerning';
  var OFFSET_KERNING_PAIR = -0.4;
  var OFFSET_KERNING_SOLO = -0.5;
  var kerningInfo = {};
  makeKerningPairs(kerningInfo, ['、', '，', '。', '．', '・', '｜', '：', '　'], ['「', '『', '（', '［', '｛', '〈', '《', '【', '〔']);
  makeKerningPairs(kerningInfo, ['」', '』', '）', '］', '｝', '〉', '》', '】', '〕'], ['、', '，', '。', '．', '・', '｜', '：', ',', '.']);
  makeKerningPairs(kerningInfo, ['」', '』', '）', '］', '｝', '〉', '》', '】', '〕'], ['「', '『', '（', '［', '｛', '〈', '《', '【', '〔']);
  makeKerningPairs(kerningInfo, ['「', '『', '（', '［', '｛', '〈', '《', '【', '〔'], ['「', '『', '（', '［', '｛', '〈', '《', '【', '〔']);
  makeKerningPairs(kerningInfo, ['」', '』', '）', '］', '｝', '〉', '》', '】', '〕'], ['」', '』', '）', '］', '｝', '〉', '》', '】', '〕']);
  makeKerningSolos(kerningInfo, ['「', '『', '（', '［', '｛', '〈', '《', '【', '〔']);
  var ts = document.querySelectorAll(TARGET_SELECTOR);

  for (var i = 0; i < ts.length; i += 1) {
    applyKerningToElement(ts[i], kerningInfo);
  }

  ts = document.querySelectorAll(TARGET_SELECTOR_KERNING);

  for (var _i = 0; _i < ts.length; _i += 1) {
    applyKerningToElement(ts[_i], kerningInfo);
  } // -------------------------------------------------------------------------


  function makeKerningPairs(ki, tail, head) {
    for (var _i2 = 0; _i2 < head.length; _i2 += 1) {
      for (var j = 0; j < tail.length; j += 1) {
        ki[tail[j] + head[_i2]] = OFFSET_KERNING_PAIR;
      }
    }
  }

  function makeKerningSolos(ki, head) {
    for (var _i3 = 0; _i3 < head.length; _i3 += 1) {
      ki[head[_i3]] = OFFSET_KERNING_SOLO;
    }
  }

  function applyKerningToElement(elm, ki) {
    var cs = Array.prototype.slice.call(elm.childNodes, 0);

    for (var _i4 = 0; _i4 < cs.length; _i4 += 1) {
      var c = cs[_i4];

      if (c.nodeType === 1
      /*ELEMENT_NODE*/
      ) {
          if (!ST.containStile(c, ST_NO_KERNING)) applyKerningToElement(c, ki);
        } else if (c.nodeType === 3
      /*TEXT_NODE*/
      ) {
          var text = c.textContent;
          var prev = c.previousSibling;
          var isParentBlock = isBlockParent(c.parentNode);

          if (isParentBlock) {
            var next = c.nextSibling;

            if (!prev || isBlockSibling(prev)) {
              var zs = text.match(/^(\u3000*)/g);
              text = zs + text.replace(/^\s+/g, ''); // trim left
            }

            if (!next || isBlockSibling(next)) text = text.replace(/\s+$/g, ''); // trim right
          }

          var es = applyKerning(text, ki, isParentBlock && (prev === null || isBlockSibling(prev)));
          if (es.length <= 0) continue;
          c.parentNode.replaceChild(es[0], c);
          var ns = es[0].nextSibling;

          if (ns) {
            for (var j = 1; j < es.length; j += 1) {
              ns.parentNode.insertBefore(es[j], ns);
            }
          } else {
            for (var _j = 1; _j < es.length; _j += 1) {
              es[0].parentNode.appendChild(es[_j]);
            }
          }
        }
    }
  }

  function isBlockParent(elm) {
    if (!(elm instanceof HTMLElement)) return false;
    var d = getComputedStyle(elm).display;
    if (d.indexOf('inline') === -1) return true;

    if (d.indexOf('inline-block') !== -1) {
      // is inline block
      var cs = elm.childNodes;

      if (cs.length === 1 && cs[0].nodeType === 3
      /*TEXT_NODE*/
      ) {
          if (elm.parentNode) {
            var pd = getComputedStyle(elm.parentNode).display;
            if (pd.indexOf('inline') === -1 && elm.parentNode.firstChild === elm) return true;
          }

          return false; // When it has only one text child
        }

      return true;
    }

    return false;
  }

  function isBlockSibling(elm) {
    if (!(elm instanceof HTMLElement)) return false;
    var d = getComputedStyle(elm).display;
    return d.indexOf('inline') === -1 || elm.tagName === 'BR';
  }

  function applyKerning(text, ki, isHead) {
    var res = [];
    var temp = ''; // White Space Character Class Excluding \u3000
    // [ \f\n\r\t\v​\u00a0​\u180e\u2000​-\u200a​\u2028\u2029\u202f\u205f​\ufeff]

    text = text.replace(/([^\x01-\x7E\xA1-\xDF]+)([\t\n]+|[ \f\n\r\t\v\u00a0\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\ufeff]{2})([^\x01-\x7E\xA1-\xDF]+)/g, function (match, g1, d, g2) {
      return g1 + g2;
    });

    for (var _i5 = 0, I = text.length; _i5 < I; _i5 += 1) {
      var ch1 = text.substr(_i5, 1);
      var ch2 = text.substr(_i5 + 1, 1);
      var space = 0;
      var style = '';

      if (ch1 !== '' && ch2 !== '' && ki[ch1 + ch2]) {
        space = ki[ch1 + ch2];
        style = 'letter-spacing:' + space + 'em;';
      }

      if (_i5 === 0 && ch1 !== '' && ki[ch1] && isHead) {
        style += 'margin-left:' + ki[ch1] + 'em;';
      }

      if (style.length > 0) {
        if (temp.length > 0) {
          res.push(document.createTextNode(temp));
          temp = '';
        }

        var span = document.createElement('span');
        span.innerText = ch1;
        span.setAttribute('style', style);
        res.push(span);
      } else {
        temp += ch1;
      }
    }

    if (temp.length > 0) res.push(document.createTextNode(temp));
    return res;
  }
});
"use strict";

/**
 *
 * Japanese Text Segmenter
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2019-03-05
 *
 */
window.ST = window['ST'] || {};
ST.addInitializer(6, function () {
  var TARGET_SELECTOR = '.stile';
  var TARGET_SELECTOR_SEGMENTER = '.stile-segmenter';
  var CTYPES = ['S', 'E', 'I', 'K', 'H'];
  var CPATS = {
    S: /[\u3008\u300A\u300C\u300E\u3010\u3014\u3016\u3018\u301A\uFF08\uFF1C\uFF3B\uFF5B]/,
    E: /[\u3001\u3002\u3009\u300B\u300D\u300F\u3011\u3015\u3017\u3019\u301B\u3092\uFF01\uFF09\uFF0C\uFF0E\uFF1A\uFF1E\uFF1F\uFF3D\uFF5D]/,
    I: /[\u3041-\u3093\u309D]/,
    K: /[\u30A1-\u30F4\u30FC\uFF70-\uFF9E]/,
    H: /[\u3005\u3006\u30F5\u30F6\u4E00-\u9FA0]/
  };
  var PAIRS = {
    'S*': 1,
    '*E': 1,
    'II': 1,
    'KK': 1,
    'HH': 1,
    'HI': 1
  };
  var JOSHI_A = 'でなければ|について|かしら|くらい|けれど|なのか|ばかり|ながら|ことよ|こそ|こと|さえ|しか|した|たり|だけ|だに|だの|つつ|ても|てよ|でも|とも|から|など|なり|ので|のに|ほど|まで|もの|やら|より|って|で|と|な|に|ね|の|も|は|ば|へ|や|わ|を|か|が|さ|し|ぞ|て'.split('|');
  var JOSHI_H = {};

  for (var i = 0; i < JOSHI_A.length; i += 1) {
    JOSHI_H[JOSHI_A[i]] = true;
  }

  for (var _i = 1; _i <= 6; _i += 1) {
    var _ts = document.querySelectorAll(TARGET_SELECTOR + ' h' + _i + ':not([class])');

    for (var _i2 = 0; _i2 < _ts.length; _i2 += 1) {
      applySeparaterToElement(_ts[_i2]);
    }
  }

  var ts = document.querySelectorAll(TARGET_SELECTOR_SEGMENTER);

  for (var _i3 = 0; _i3 < ts.length; _i3 += 1) {
    applySeparaterToElement(ts[_i3]);
  } // -------------------------------------------------------------------------


  function applySeparaterToElement(elm) {
    var cs = Array.prototype.slice.call(elm.childNodes, 0);
    var tn = elm.tagName;
    var fs = [];

    for (var _i4 = 0; _i4 < cs.length; _i4 += 1) {
      var c = cs[_i4];

      if (c.nodeType === 1
      /*ELEMENT_NODE*/
      ) {
          applySeparaterToElement(c);
          fs.push(c.outerHTML);
        } else if (c.nodeType === 3
      /*TEXT_NODE*/
      ) {
          fs.push(separateTextAndMakeSpans(c.textContent, tn));
        }
    }

    elm.innerHTML = fs.join('');
  }

  function separateTextAndMakeSpans(text, tn) {
    var parts = [];
    var t_prev = '';
    var word = '';
    var isHira = true;

    for (var _i5 = 0, I = text.length; _i5 < I; _i5 += 1) {
      var c = text.substr(_i5, 1);
      var t = getCtype(c);

      if (PAIRS[t_prev + t] || PAIRS['*' + t] || PAIRS[t_prev + '*']) {
        word += c;
        if (t !== 'I') isHira = false;
      } else if (t === 'O') {
        if (t_prev === 'O') {
          word += c;
          if (t !== 'I') isHira = false;
        } else {
          if (0 < word.length) parts.push([word, true, isHira]);
          word = c;
          isHira = t === 'I';
        }
      } else {
        if (0 < word.length) parts.push([word, t_prev !== 'O', isHira]);
        word = c;
        isHira = t === 'I';
      }

      t_prev = t;
    }

    if (0 < word.length) parts.push([word, t_prev !== 'O', isHira]);
    var newParts = concatenateJoshi(parts);
    if (newParts.length === 1 && tn === 'SPAN') return text;
    return wrapWithSpan(newParts);
  }

  function concatenateJoshi(parts) {
    var newParts = [];
    var prevWs = null;

    for (var _i6 = 0, I = parts.length; _i6 < I; _i6 += 1) {
      var ws = parts[_i6];

      if (prevWs && prevWs[1] && ws[2] && JOSHI_H[ws[0]]) {
        prevWs[0] += ws[0];
      } else {
        newParts.push(ws);
        prevWs = ws;
      }
    }

    return newParts;
  }

  function wrapWithSpan(parts) {
    var ret = '';

    for (var _i7 = 0, I = parts.length; _i7 < I; _i7 += 1) {
      var ws = parts[_i7];
      ret += ws[1] ? '<span>' + ws[0] + '</span>' : ws[0];
    }

    return ret;
  }

  function getCtype(c) {
    for (var _i8 = 0; _i8 < CTYPES.length; _i8 += 1) {
      var t = CTYPES[_i8];
      var p = CPATS[t];
      if (p.test(c)) return t;
    }

    return 'O';
  } // -------------------------------------------------------------------------


  ST['segmenter'] = {
    applySeparaterToElement: applySeparaterToElement,
    separateTextAndMakeSpans: separateTextAndMakeSpans
  };
});